2D SIMULATION OF HIGH-EFFICIENCY CROSS-FIELD RF POWER

SOURCESâˆ—

Valery A. Dolgashev, Sami G. Tantawiâ€ , SLAC, Stanford, CA 94309, USA
1

INTRODUCTION

also use cavity modes with eigen-frequencies close to the
working frequency.

0
0
0
2

 

g
u
A
0
2

 

 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 

1
v
7
7
1
8
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

In a cross ï¬eld device[1] such as magnetron or cross ï¬eld
ampliï¬er electrons move in crossed magnetic and electric
ï¬elds. Due to synchronism between electron drift velocity
and phase velocity of RF wave, the wave bunches the beam,
electron spokes are formed and the bunched electrons are
decelerated by the RF ï¬eld. Such devices have high efï¬-
ciency (up to 90%), high output power and relatively low
cost. Electrical design of the cross-ï¬eld devices is difï¬-
cult. The problem is 2D (or 3D) and highly nonlinear. It
has complex geometry and strong space charge effects. Re-
cently, increased performance of computers and availabil-
ity of Particle-In-Cell (PIC) codes[2, 3], have made possi-
ble the design of relatively low efï¬ciency devices such as
relativistic magnetrons or cross ï¬eld ampliï¬ers [4]. Sim-
ulation of high efï¬ciency (âˆ¼ 90%) devices is difï¬cult due
to the long transient process of starting oscillations. Use
of PIC codes for design of such devices is not practical. In
this report we describe a frequency domain method that de-
veloped for simulating high efï¬ciency cross-ï¬eld devices.
In the method, we consider steady-state interaction of par-
ticles with the modes of RF cavity at dominant frequency.
Self-consistency of the solution is reached by iterations un-
til power balance is achieved.

2 PHYSICAL MODEL

Cross-ï¬eld devices consist of a cathode and a surround-
ing anode. The structure is a cavity with a set of resonant
eigenmodes. Macroparticles are emitted from the cathode
and moved by forces of electromagnetic ï¬elds. The elec-
tromagnetic ï¬elds are determined by applied external elec-
tric potential between anode and cathode, oscillating ï¬eld
of cavity modes, and space charge ï¬elds. We use geom-
etry with arbitrary piece-wise planar boundaries. In order
to solve the electrostatic and electrodynamic problems, we
apply methods that do not require mesh generation. Inter-
action with magnetic ï¬eld is determined by uniform mag-
netic ï¬eld Hz which is parallel to z-axis and orthogonal
to the plane of simulation. There are several assumptions
that we use to simplify the problem. These assumptions are
based on the working regime of the devices that we want to
simulate. Devices will have low current density, are non-
relativistic, and have resonant systems with a relatively low
density of the cavity modes. Hence, we can neglect mag-
netic ï¬elds due to space charge and cavity modes. We can

âˆ— This work was supported by the U.S. Department of Energy contract

DE-AC03-76SF00515.

â€  Also with the Communications and Electronics Department, Cairo

University, Giza, Egypt.

2.1 Basic equations
We are solving a steady state problem of electron beam
ï¬‚ow in self-consistent electromagnetic ï¬elds. Total ï¬elds
are superposition of static electric ~E â€² and magnetic ~H â€²
ï¬elds, and â€œoscillatingâ€ electric ~E(Ï‰) and magnetic ~H(Ï‰)
ï¬elds as

~E(t) = ~E â€²+â„œe{ ~E(Ï‰)ejÏ‰t}, ~H(t) = ~H â€²+â„œe{ ~H(Ï‰)ejÏ‰t}.

Here Ï‰ is angular frequency, t is time. We separate the elec-
trodynamic problem into two parts. The ï¬rst part â€“ electro-
static potential Î¦ is generated by â€œexternalâ€ anode-cathode
potential and by the static component of the space-charge
electric ï¬elds. The second part â€“ the dynamic electromag-
netic ï¬elds have a harmonic ejÏ‰t time (t) dependence.

Static ï¬elds

2.2
We ï¬nd the static electric ï¬eld from ~E â€² = âˆ’âˆ‡Î¦, using the
Poisson equation:

âˆ‡2Î¦ = âˆ’

,

(1)

Ï
Ç«0

where âˆ‡ is the gradient operator, Ï is volume charge den-
sity averaged over oscillation period T = 2Ï€/Ï‰. Ç«0 is the
electric permittivity of the vacuum.

2.3 Oscillating ï¬elds
To solve the second part of the problem, we write the time
harmonic Maxwell equations as

âˆ‡ Ã— ~E = âˆ’jÏ‰Âµ0 ~H, âˆ‡ Ã— ~H = jÏ‰Ç«0 ~E + ~JÏ‰.

(2)

Here ~JÏ‰ is electric current density, Âµ0 is the magnetic per-
meability of vacuum. Oscillating ï¬elds inside a cavity are
expanded in terms of the cavity eigenmodes ( ~Es, ~Hs) and
the fast oscillating electric potential Ï•Ï‰ as

~E =Xs

As ~Es âˆ’ âˆ‡Ï•Ï‰, ~H =Xs

Bs ~Hs.

(3)

Here s is mode index, As and Bs are the eigenmode am-
plitudes. Using the expansion (3) we get the Poisson equa-
tion for the potential:

âˆ‡2Ï• =

âˆ‡ Â· ~JÏ‰
jÏ‰Ç«0

= âˆ’

ÏÏ‰
Ç«0

,

(4)

where ÏÏ‰ is the oscillating space-charge density. Ampli-
tudes of the electric ï¬eld expansion are given by

Ï‰

As =

j(Ï‰2 âˆ’ Ï‰2

s ) RV
Ç«0RV

~JÏ‰ ~E âˆ—
s dV
~Es ~E âˆ—
s dV

.

(5)

Here Ï‰s is the mode eigen-frequency of the mode , V is the
cavity volume.

2.4 Equation of motion
Equation of motion for an electron in crossed-ï¬elds is

d~p
dt

= qe ~E(t) + Âµ0~v Ã— Hz,

(6)

where ~p is the relativistic momentum, qe is the charge, and
~v is the velocity of the electron. Current density induced by
the electron motion is ~J = qe~vÎ´(~r), where ~r is the position
vector of the electron, and Î´ is the Kronecker delta function.

3 NUMERICAL METHODS

We created several separate program modules to simulate a
cross-ï¬eld device. First is an RF ï¬eld solver that calculates
eigenmodes and eigen-frequencies in the cavity; second is
the Poisson solver that ï¬nds electric ï¬elds due to external
potential, static space charge, and oscillating space charge;
and third, the tracking module that performs tracking of
electrons through electromagnetic ï¬elds. For simulation,
we consider an arbitrary, piecewise bounded 2D geometry.

3.1 Planar geometry

#

"

$

%







&

'

!

 



2HJ

;

'

&

%



O

Î“

$

N

 

!

"
 

#

2HJ 

; 

Figure 1: Planar geometry.

The geometry is cylindrical (uniform in the z-direction)
as illustrated on Fig. 1. It consists of planar sidewalls and
apertures. The geometry in the x, y plane can be described
by a set of points zs = (xs, ys), where s = 1, 2..., N â€²; here
N â€² is the total number of sidewalls and apertures. Periodic
boundary conditions are applied to the apertures. The pe-
riodic boundary allows us to use only part of the structure
and signiï¬cantly reduce simulation time. In the particular
case shown in Fig. 1 the geometry has N â€² = 19 sidewalls,
two apertures (ports) with starting points p = 1, 15, and
the cathode and anode determined by s = 16, 17, 18, 19, 1
and s = 2, 3, ..., 15 respectively.

3.2 RF ï¬eld solver
The description of the RF solver that is used in this method
is published in [5]. Here we brieï¬‚y outline its properties.
We use the scattering matrix approach [6] to calculate the
dispersion parameters of the periodic 2D structure, itâ€™s res-
onant frequencies, and the corresponding ï¬elds. The ï¬elds
are described by functional expansion. Boundary contour
mode-matching is applied in a piecewise bounded 2D re-
gion is applied to obtain the scattering matrix and ï¬eld am-
plitudes [7]. The Galerkin method is used for the mode-
matching procedure. The geometry is divided into regions,
and electromagnetic ï¬elds in each region are expanded in

series of plane waves or (for low frequencies) Bessel func-
tions. Scattering matrices from the regions are combined
using the generalized scattering matrix technique. Reso-
nant and periodic boundary conditions [6] are used to ob-
tain resonant frequencies, dispersion parameters, and cor-
responding ï¬elds. We calculate the electric ï¬elds on a polar
grid (only in the region of ï¬eld-particle interaction), in or-
der to speed up calculation of ï¬elds for the macroparticle
tracking. To obtain ï¬eld at the macroparticle position we
use 2D spline interpolation.

3.3 Poisson solver
We use an efï¬cient method for solving the Poisson equa-
tion for electric ï¬elds in a 2-D, arbitrarily shaped geometry.
The solution is based on the method of moments. Point-
matching in a piecewise bounded 2D region is applied to
obtain the charge density on the boundary. The boundaryâ€™s
charge density determines the ï¬elds and potentials through-
out the interior region. We use a complex representation
of the ï¬elds and potentials in the solution [8]. We apply
periodic boundary conditions to simulate the ï¬elds in the
periodic structure.

Formulation We solve equation (1) in 2D. In the 2D
case it is advantageous to represent the position and ï¬eld
vectorâ€™s (x, y) components by a single complex represen-
tation. We will work with functions of a complex variable

z = x + jy. The ï¬eld strength eE can be written in terms of

the scalar potential Î¦ = Î¦(z) as

dÎ¦âˆ—
dz

.

(7)

eE(z) = âˆ’

Here âˆ— represents the complex conjugate. An effective line
charge q (point charge in 2D geometry) has the complex
potential Î¦ = (q/Ç«0) log z. We approximate the charge dis-
tribution on the boundary of the region as a sum of â€œstepâ€
functions. We divide each element(sidewall and aperture)
of the boundary into Nb straight pieces or â€œcharged linesâ€
with uniform charge density Ïƒ along the piece. A uniformly
charged straight wall with beginning and end coordinates
z1 and z2, respectively, will produce a complex potential at
the point zw

Î¦(zw) =ZL

Ïƒ
Ç«0

log(z âˆ’ zw)dz,

(8)

where L is the contour along the line. Equation (8) is inte-
grated analytically.

Field strength of the charged wall We obtain the
electric ï¬eld of the charged line by substituting (8) into (7):

eE(zw)Ç«0

Ïƒ

=(cid:20) |z1 âˆ’ z2|

z1 âˆ’ z2

log(cid:18) zw âˆ’ z1

zw âˆ’ z2(cid:19)(cid:21)âˆ—

.

(9)

The value of the function is undeï¬ned on the lineâ€™s contour.
However, for us, the ï¬elds inside the region are of interest.
Therefore, the direction of the ï¬eld (for positive charge)

on the lineâ€™s contour is chosen to be directed inward. Also
singularities at points z1 and z2 can affect the ï¬eldâ€™s cal-
culation. Macroparticles with ï¬nite dimensions are used to
avoid this singularity.

deï¬ned and there is no difï¬culty in solving the system di-
rectly. For macroparticle tracking, the electric ï¬eld calcu-
lated on polar grid and then interpolated at the macroparti-
cle position (same as for RF ï¬elds).

Periodic boundary condition We assume that the po-
tential and ï¬eld strength are repeated on the periodâ€™s aper-
tures (Fig. 1). Let z â€²
2. If we shift the
region to the right so it coincides with the next period, the
coordinate z â€²
2. The
periodic boundary condition becomes

1 will be transformed into coordinate z â€²

1 and z â€²

1 âˆˆ Y â€²

2 âˆˆ Y â€²

Î¦(z â€²

1) = Î¦(z â€²

2),

âˆ‚Î¦(z â€²
1)
âˆ‚n

= âˆ’

âˆ‚Î¦(z â€²
2)
âˆ‚n

.

(10)

We assume the Dirichlet condition on the sidewalls (except
for the apertures) as

Î¦(Î“â€²) = Î¶(Î“â€²), Î“ = Î“â€² + Y â€²

1 + Y â€²
2 .

(11)

Integral equations For periodic boundary conditions
(10) and (11) surface charge density Ïƒ must satisfy the cou-
pled integral equations

ï£±ï£´ï£´ï£´ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£´ï£´ï£´ï£³

RÎ“ log(zw âˆ’ z)Ïƒ(z)dz = Ç«0Î¶(zw), zw âˆˆ Î“â€²,
1 âˆ’ z)Ïƒ(z)dz =RÎ“ log(z â€²
RÎ“ log(z â€²
RÎ“n âˆ‚ log(zâ€²
= âˆ’RÎ“n âˆ‚ log(zâ€²

oâˆ—
dzoâˆ—

Ïƒ(z)dz âˆ’ Ï€Ïƒ(z2),
2 âˆˆ Y â€²
2 ,

Ïƒ(z)dz + Ï€Ïƒ(z â€²

z âˆˆ Î“, z â€²

1 âˆˆ Y â€²

1 , z â€²

1) =

âˆ’z)

âˆ’z)

2 âˆ’ z)Ïƒ(z)dz,

âˆ‚np

2

1

âˆ‚np

âˆ’z)

(12)
in which âˆ‚ log(zw
denotes the normal derivative of
âˆ‚np
log(zw âˆ’ z) at the point zw assuming z is ï¬xed; Î“ =
2; coordinates z1 and z2 are the same as in
Î“â€² + Y â€²
(10); and Î¶(zw) is the external potential.

1 + Y â€²

,

ï£¼ï£´ï£´ï£´ï£´ï£´ï£´ï£½
ï£´ï£´ï£´ï£´ï£´ï£´ï£¾

Numerical approximation We solve the integral
equation numerically, by approximating the source densi-
ties by step-functions [9]. Thus we divide the given bound-
ary Î“ into NÎ“ intervals and assume that the simple source
density Ïƒ has a constant value within each interval. Then
denoting these constant values by Ïƒi, i = 1, 2, ..., NÎ“, we
approximate Î¦ and E by

ÏƒiÇ«0Zi
NÎ“Xi=1
bÎ¦(zw) =
Ç«0 Zi(cid:18) d log(zw âˆ’ z)
NÎ“Xi=1
bE(zw) =

dzw

Ïƒi

log(zw âˆ’ z)dz, and

(13)

(cid:19)âˆ—

dz,

(14)

whereRi denotes integration over the i-th interval of Î“. We

substitute (13) and (14) into (12) to obtain numerical ap-
proximation for periodic solution. The unknowns (in the
system obtained) are the charge density on the intervals Ïƒi,
the potential and the electric ï¬eld on the periodic aperture.
All coefï¬cients in the system are calculated analytically.
For practical geometries, the matrix of coefï¬cients is well

3.4 Tracking
We ï¬nd a macroparticle trajectory by using the 4th order
Runge-Kutta method for integrating the equation of mo-
tion (6) in polar coordinates. Then, we integrate the com-
plex electric ï¬eld of the cavity modes along the trajectory to
ï¬nd coefï¬cients for the cavityâ€™s eigenmodes (5). We mon-
itor energy conservation in order to verify accuracy of cal-
culation. For that purpose we use total energy that consists
of kinetic energy of the macroparticle and integral of static
(due to external potential and static space charge) and os-
cillating (due to cavity modes and oscillating space charge)
electric ï¬elds along the trajectory. Initial charge and ve-
locity ~v are determined by a space-charge-limited-emission
model and a relaxation scheme.

3.5 Algorithm
We start simulation by calculating dispersion the curve for
the spatial period of the device (using the RF ï¬eld solver).
Then, we calculate electric ï¬elds for the eigenmodes. Next,
(using the Poisson solver) we calculate electric ï¬eld due to
external potential. Next, we start iterations using Track-
ing module to ï¬nd the macroparticle trajectories, ï¬eld inte-
grals along the trajectories, and electric ï¬elds due to space
charge. Next, we update the static and oscillating ï¬elds and
start new iteration.

4 SUMMARY

We have written a C++ computer code that uses meth-
ods, described above. Accuracy of resonant frequency
calculation by RF ï¬eld solver for typical geometries is
âˆ¼ 0.1%. We tested performance of Poisson solver and
Tracking module on diode geometries (without magnetic
ï¬eld). We calculated diode current with typical accuracy
2-3% in comparison with analytical solution. Testing of
the code on cross- ï¬eld devices is under way.

5 REFERENCES

[1] G. B. Collins, â€œMicrowave Magnetrons,â€ Boston tech. pub., Inc.,

1964.

[2] B.Goplen at al, â€œUser-conï¬gurable MAGIC Code for Electromag-
netic PIC Calculations,â€ Comp. Phys. Comm., vol.87, pp. 54-86,
1995.

[3] K. R. Eppley,

â€œNumerical

Simulation Of Cross

Field

Ampliï¬ers,â€SLAC-PUB-5183, 1990.

[4] X. Chen, at al, â€œ2D/3D magnetron modeling,â€2nd Int. Conf. On Cross

Field Devices and Appl., Boston, MA, USA, 17-19 June, 1998.

[5] V.A. Dolgashev, S.G. Tantawi, â€œMethod for Efï¬cient Analysis of
Waveguide Components and Cavities for RF Sources,â€ EPACâ€™2000,
26-30 June 2000, Austria Center, Vienna.

[6] V. A. Dolgashev, â€œCalculation of Impedance for Multiple Waveg-
uide Junction Using Scattering Matrix Formulation,â€ presented at
ICAPâ€™98, Monterrey, CA, USA, 14-18 Sept., 1998.

[7] J. M. Reiter and F. Arndt,

IEEE Trans. Microwave Theory Tech.,

vol. 43, pp. 796-801, Apr. 1995.

[8] R. B. Beth, â€œComplex Representation and Computation of Two-
Dimensional Magnetic Fieldsâ€, Journal of Applied Physics, Vol. 37,
Number 7, June, 1966.

[9] L. M. Delves and J. Walsh, â€œNumerical Solution of Integral Equa-

tions,â€ Clarendon Press, Oxford, 1974.

